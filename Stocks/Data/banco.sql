CREATE TABLE IF NOT EXISTS "tipo_operacao" (
	"id"	integer,
	"nome"	text NOT NULL UNIQUE,
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "tipo_evento" (
	"id"	integer,
	"nome"	text NOT NULL UNIQUE,
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "tipo_ativo" (
	"id"	integer,
	"nome"	text NOT NULL UNIQUE,
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "ativo" (
	"id"	integer,
	"codigo"	text NOT NULL UNIQUE,
	"nome"	text NOT NULL,
	"descricao_nota"	text NOT NULL,
	"tipo_acao"	text,
	"preco_medio"	DECIMAL(10, 5),
	"posicao"	integer,
	"cnpj"	text NOT NULL,
	"cnpj_fonte_pagadora"	text,
	"fator_preco_teto" DECIMAL(10, 5),
    "preco_teto_medio" DECIMAL(10, 5),
    "preco_teto_projetivo" DECIMAL(10, 5),
	"tipo_ativo_id"	integer NOT NULL,
	CONSTRAINT "fk_ativo_tipo_ativo" FOREIGN KEY("tipo_ativo_id") REFERENCES "tipo_ativo"("id"),
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "evento" (
	"id"	integer,
	"data"	datetime NOT NULL,
	"fator"	integer NOT NULL,
	"valor" DECIMAL(10, 5),
	"tipo_evento_id"	integer NOT NULL,
	"ativo_id"	integer NOT NULL,
	CONSTRAINT "fk_evento_tipo_evento" FOREIGN KEY("tipo_evento_id") REFERENCES "tipo_evento"("id"),
	CONSTRAINT "fk_evento_ativo" FOREIGN KEY("ativo_id") REFERENCES "ativo"("id"),
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "provento" (
	"id"	integer,
	"valor"	DECIMAL(10, 5) NOT NULL,
	"data"	datetime NOT NULL,
	"ativo_id"	integer NOT NULL,
	CONSTRAINT "fk_provento_ativo" FOREIGN KEY("ativo_id") REFERENCES "ativo"("id"),
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "irrf" (
	"id"	integer,
	"valor"	DECIMAL(10, 5) NOT NULL,
	"data"	datetime NOT NULL,
	"tipo_operacao_id"	integer NOT NULL,
	CONSTRAINT "fk_irrf_tipo_operacao" FOREIGN KEY("tipo_operacao_id") REFERENCES "tipo_operacao"("id"),
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "posicao_fim_ano" (
	"id"	integer,
	"ano"	integer NOT NULL,
	"preco_medio"	DECIMAL(10, 5) NOT NULL,
	"custo_total" DECIMAL(10, 5) NOT NULL,
	"posicao"	integer NOT NULL,
	"ativo_id"	integer NOT NULL,
	CONSTRAINT "fk_posicao_fim_ano_ativo" FOREIGN KEY("ativo_id") REFERENCES "ativo"("id"),
	PRIMARY KEY("id")
);
CREATE TABLE IF NOT EXISTS "operacao" (
	"id"	integer,
	"data"	datetime NOT NULL,
	"quantidade"	integer,
	"preco_ativo"	DECIMAL(10, 5),
	"valor_total"	DECIMAL(10, 5),
	"taxas"	DECIMAL(10, 5),
	"compra"	numeric NOT NULL,
	"lucro_liquido"	DECIMAL(10, 5),
	"ativo_id"	integer NOT NULL,
	"tipo_operacao_id"	integer NOT NULL,
	CONSTRAINT "fk_operacao_tipo_operacao" FOREIGN KEY("tipo_operacao_id") REFERENCES "tipo_operacao"("id"),
	CONSTRAINT "fk_operacao_ativo" FOREIGN KEY("ativo_id") REFERENCES "ativo"("id"),
	PRIMARY KEY("id")
);
INSERT INTO "tipo_operacao" VALUES (1,'Swing Trade'),
 (2,'Day Trade'),
 (3,'FII');
INSERT INTO "tipo_evento" VALUES (1,'Desdobramento'),
 (2,'Grupamento'),
 (3,'Bonificação');
INSERT INTO "tipo_ativo" VALUES (1,'Ação'),
 (2,'FII'),
 (3,'ETF'),
 (4,'CALL'),
 (5,'PUT');
INSERT INTO "ativo"
(id, codigo, nome, descricao_nota, tipo_acao, preco_medio, posicao, cnpj, cnpj_fonte_pagadora,
 preco_teto_medio, preco_teto_projetivo, tipo_ativo_id)
VALUES
 (1,'ITSA3','Itaúsa','ITAUSA','ON',NULL,NULL,'61.532.644/0001-15',NULL, NULL, NULL, 1),
 (2,'ITSA4','Itaúsa','ITAUSA','PN',NULL,NULL,'61.532.644/0001-15',NULL, NULL, NULL, 1),
 (3,'SBSP3','SABESP','SABESP','ON',NULL,NULL,'43.776.517/0001-80',NULL, NULL, NULL, 1),
 (4,'FLRY3','Fleury','FLEURY','ON',NULL,NULL,'60.840.055/0001-31',NULL, NULL, NULL, 1),
 (5,'IRBR3','IRB Brasil','IRBBRASIL RE','ON',NULL,NULL,'33.376.989/0001-91',NULL, NULL, NULL, 1),
 (6,'RAIL3','RUMO S.A.','RUMO S.A.','ON',NULL,NULL,'02.387.241/0001-60',NULL, NULL, NULL, 1),
 (7,'TCSA3','Tecnisa','TECNISA','ON',NULL,NULL,'08.065.557/0001-12',NULL, NULL, NULL, 1),
 (8,'B3SA3','B3','B3','ON',NULL,NULL,'09.346.601/0001-25',NULL, NULL, NULL, 1),
 (9,'VVAR3','Via Varejo','VIAVAREJO','ON',NULL,NULL,'33.041.260/0652-90',NULL, NULL, NULL, 1),
 (10,'ABEV3','AMBEV','AMBEV S/A','ON',NULL,NULL,'07.526.557/0001-00',NULL, NULL, NULL, 1),
 (11,'JHSF3','JHSF Participações','JHSF PART','ON',NULL,NULL,'08.294.224/0001-65',NULL, NULL, NULL, 1),
 (12,'OIBR3','OI','OI','ON',NULL,NULL,'76.535.764/0001-43',NULL, NULL, NULL, 1),
 (13,'OIBR4','OI','OI','PN',NULL,NULL,'76.535.764/0001-43',NULL, NULL, NULL, 1),
 (14,'BIDI4','Banco Inter','BANCO INTER','PN',NULL,NULL,'00.416.968/0001-01',NULL, NULL, NULL, 1),
 (15,'UGPA3','Ultrapar','ULTRAPAR','ON',NULL,NULL,'33.256.439/0001-39',NULL, NULL, NULL, 1),
 (16,'ALPA3','Alpargatas','ALPARGATAS','ON',NULL,NULL,'61.079.117/0001-05',NULL, NULL, NULL, 1),
 (17,'ALPA4','Alpargatas','ALPARGATAS','PN',NULL,NULL,'61.079.117/0001-05',NULL, NULL, NULL, 1),
 (18,'STBP3','Santos Brasil','SANTOS BRP','ON',NULL,NULL,'02.762.121/0001-04',NULL, NULL, NULL, 1),
 (19,'CEAB3','C&A','CEA MODAS','ON',NULL,NULL,'45.242.914/0001-05',NULL, NULL, NULL, 1),
 (20,'CIEL3','Cielo','CIELO','ON',NULL,NULL,'01.027.058/0001-91',NULL, NULL, NULL, 1),
 (21,'WEGE3','WEG','WEG','ON',NULL,NULL,'84.429.695/0001-11',NULL, NULL, NULL, 1),
 (22,'GRND3','Grendene','GRENDENE','ON',NULL,NULL,'89.850.341/0001-60',NULL, NULL, NULL, 1),
 (23,'QUAL3','Qualicorp','QUALICORP','ON',NULL,NULL,'11.992.680/0001-93',NULL, NULL, NULL, 1),
 (24,'BRCR11','FDO INV-FII BTG Pactual IMOB CORPORATE OFFICE FUND','BRCR11','',NULL,NULL,'08.924.783/0001-01',NULL, NULL, NULL, 2),
 (25,'MALL11','MALLS BRASIL PLURAL FDO INV IMOB','MALL11','',NULL,NULL,'26.499.833/0001-32',NULL, NULL, NULL, 2),
 (26,'FLMA11','FII CONTINENTAL SQUARE FARIA LIMA','FLMA11','',NULL,NULL,'04.141.645/0001-03',NULL, NULL, NULL, 2),
 (27,'BOVA11','BOVA11','ISHARES BOVA','CI',NULL,NULL,'10.406.511/0001-61', NULL, NULL, NULL, 3),
 (28,'LREN3','Lojas Renner','LOJAS RENNER','ON',NULL,NULL,'92.754.738/0001-62',NULL, NULL, NULL, 1),
 (29,'BBDC3','Bradesco','BRADESCO','ON',NULL,NULL,'60.746.948/0001-12',NULL, NULL, NULL, 1),
 (30,'BBAS3','Banco do Brasil','BRASIL','ON',NULL,NULL,'00.000.000/0001-91',NULL, NULL, NULL, 1),
 (31,'ENBR3','Energias do Brasil','ENERGIAS BR','ON',NULL,NULL,'03.983.431/0001-03',NULL, NULL, NULL, 1),
 (32,'TAEE11','TAESA','TAESA','UNT',NULL,NULL,'07.859.971/0001-30',NULL, NULL, NULL, 1),
 (33,'ARZZ3','Arezzo','AREZZO CO','ON',NULL,NULL,'16.590.234/0001-76',NULL, NULL, NULL, 1),
 (34,'EGIE3','Engie','ENGIE BRASIL','ON',NULL,NULL,'02.474.103/0001-19',NULL, NULL, NULL, 1),
 (35,'ITUB3','Itaú','ITAUUNIBANCO','ON',NULL,NULL,'60.872.504/0001-23',NULL, NULL, NULL, 1),
 (36,'PSSA3','Porto Seguro','PORTO SEGURO','ON',NULL,NULL,'02.149.205/0001-69',NULL, NULL, NULL, 1),
 (37,'ODPV3','Odontoprev','ODONTOPREV','ON',NULL,NULL,'58.119.199/0001-51',NULL, NULL, NULL, 1),
 (38,'PINE4','Banco Pine','PINE','PN',NULL,NULL,'62.144.175/0001-20',NULL, NULL, NULL, 1),
 (39,'HYPE3','Hypera Pharma','HYPERA','ON',NULL,NULL,'02.932.074/0001-91',NULL, NULL, NULL, 1),
 (40,'BBSE3','BB Seguridade','BBSEGURIDADE','ON',NULL,NULL,'17.344.597/0001-94',NULL, NULL, NULL, 1),
 (41,'MDIA3','M. Dias Branco','M.DIASBRANCO','ON',NULL,NULL,'07.206.816/0001-15',NULL, NULL, NULL, 1),
 (42,'YDUQ3','YDUQS','YDUQS PART','ON',NULL,NULL,'08.807.432/0001-10',NULL, NULL, NULL, 1),
 (43,'MRFG3','Marfrig','MARFRIG','ON',NULL,NULL,'03.853.896/0001-40',NULL, NULL, NULL, 1),
 (44,'RCSL4','Recrusul','RECRUSUL','PN',NULL,NULL,'91.333.666/0001-17',NULL, NULL, NULL, 1),
 (45,'VIVT3','Vivo','TELEF BRASIL','ON',NULL,NULL,'02.558.157/0001-62',NULL, NULL, NULL, 1),
 (46,'VIVA3','Vivara','VIVARA S.A.','ON',NULL,NULL,'33.839.910/0001-11',NULL, NULL, NULL, 1),
 (47,'LJQQ3','Lojas Quero Quero','QUERO-QUERO','ON',NULL,NULL,'96.418.264/0218-02',NULL, NULL, NULL, 1),
 (48,'GMAT3','Grupo Mateus','GRUPO MATEUS','ON',NULL,NULL,'24.990.777/0001-09',NULL, NULL, NULL, 1),
 (49,'MXRF11','MAXI RENDA FDO INV IMOB - FII','FII MAXI REN','MXRF11',NULL,NULL,'97.521.225/0001-25','59.281.253/0001-23', NULL, NULL, 2),
 (50,'HGLG11','CSHG LOGÍSTICA FDO INV IMOB - FII','FII CSHG LOG','HGLG11',NULL,NULL,'11.728.688/0001-47','61.809.182/0001-30', NULL, NULL, 2),
 (51,'KNRI11','KINEA RENDA IMOBILIÁRIA FDO INV IMOB - FII','FII KINEA','KNRI11',NULL,NULL,'12.005.956/0001-65','62.418.140/0001-31', NULL, NULL, 2),
 (52,'XPLG11','XP LOG FDO INV IMOB - FII','FII XP LOG','XPLG11',NULL,NULL,'26.502.794/0001-85','22.610.500/0001-88', NULL, NULL, 2),
 (53,'HAPV3','Hapvida','HAPVIDA','ON',NULL,NULL,'05.197.443/0001-38',NULL, NULL, NULL, 1),
 (54,'MULT3','Multiplan','MULTIPLAN','ON',NULL,NULL,'07.816.890/0001-53',NULL, NULL, NULL, 1),
 (55,'SULA11','Sulamerica','SUL AMERICA','UNT',NULL,NULL,'29.978.814/0001-87',NULL, NULL, NULL, 1),
 (56,'AERI3','Aeris','AERIS','ON',NULL,NULL,'12.528.708/0001-07',NULL, NULL, NULL, 1),
 (57,'LAME3','Lojas Americanas','LOJAS AMERIC','ON',NULL,NULL,'33.014.556/0001-96',NULL, NULL, NULL, 1),
 (58,'SAPR11','SANEPAR','SANEPAR','UNT',NULL,NULL,'76.484.013/0001-45',NULL, NULL, NULL, 1),
 (59,'ELET3','Eletrobrás','ELETROBRAS','ON',NULL,NULL,'00.001.180/0001-26',NULL, NULL, NULL, 1),
 (60,'MGLU3','Magazine Luíza','MAGAZ LUIZA','ON',NULL,NULL,'47.960.950/0001-21',NULL, NULL, NULL, 1),
 (61,'GGBR4','Gerdau','GERDAU','PN',NULL,NULL,'33.611.500/0001-19',NULL, NULL, NULL, 1),
 (62,'GGBR3','Gerdau','GERDAU','ON',NULL,NULL,'33.611.500/0001-19',NULL, NULL, NULL, 1),
 (63,'CSAN3','Cosan','COSAN','ON',NULL,NULL,'50.746.577/0001-15',NULL, NULL, NULL, 1),
 (64,'CMIN3','CSN Mineração','CSNMINERACAO','ON',NULL,NULL,'08.902.291/0001-15',NULL, NULL, NULL, 1),
 (65,'XINA11','Trend ETF MSCI China FI de Indice IE','TREND CHINA','CI',NULL,NULL,'38.542.870/0001-65', NULL, NULL, NULL, 3),
 (66,'IVVB11','iShares S&P 500 FIC de Fundo de Indice IE','ISHARE SP500','CI',NULL,NULL,'19.909.560/0001-91', NULL, NULL, NULL, 3),
 (67,'BRKM5','Braskem','BRASKEM','PNA',NULL,NULL,'42.150.391/0001-70',NULL, NULL, NULL, 1),
 (68,'SBFG3','Grupo SBF','GRUPO SBF','ON',NULL,NULL,'13.217.485/0001-11',NULL, NULL, NULL, 1),
 (69,'POMO4','Marco Polo S.A.','MARCOPOLO','PN',NULL,NULL,'88.611.835/0001-29',NULL, NULL, NULL, 1),
 (70,'RSID3','Rossi Residencial S.A.','ROSSI RESID','ON',NULL,NULL,'61.065.751/0001-80',NULL, NULL, NULL, 1),
 (71,'IRDM11','Iridium Recebíveis Imobiliários','FII IRIDIUM','IRDM11',NULL,NULL,'28.830.325/0001-10','', NULL, NULL, 2),
 (72,'SMFT3','Smart Fit','SMART FIT','ON',NULL,NULL,'07.594.978/0001-78',NULL, NULL, NULL, 1),
 (73,'TIMS3','TIM','TIM','ON',NULL,NULL,'02.421.421/0001-11',NULL, NULL, NULL, 1),
 (74,'MOVI3','Movida','MOVIDA','ON',NULL,NULL,'21.314.559/0001-66',NULL, NULL, NULL, 1),
 (75,'RAIZ4','Raízen','RAIZEN','PN',NULL,NULL,'33.453.598/0001-23',NULL, NULL, NULL, 1),
 (76,'SMAL11','SMALL11','ISHARES SMAL','CI',NULL,NULL,'10.406.600/0001-08', NULL, NULL, NULL, 3),
 (77,'OPCT3','Ocean Pact','OCEANPACT','ON',NULL,NULL,'09.114.805/0001-30',NULL, NULL, NULL, 1),
 (78,'VIIA3','VIA','VIA','ON',NULL,NULL,'33.041.260/0652-90',NULL, NULL, NULL, 1),
 (79,'CASH3','Méliuz','MELIUZ','ON',NULL,NULL,'14.110.585/0001-07',NULL, NULL, NULL, 1),
 (80,'EURP11','EURP11','TREND EUROPA','CI',NULL,NULL,'38.595.988/0001-51', NULL, NULL, NULL, 3),
 (81,'HGRU11','CSHG RENDA URBANA - FDO INV IMOB - FII','FII CSHG URB','HGRU11',NULL,NULL,'29.641.226/0001-53',NULL, NULL, NULL, 2),
 (82,'AESB3','AES Brasil','AES BRASIL','ON',NULL,NULL,'37.663.076/0001-07',NULL, NULL, NULL, 1),
 (83,'CBAV3','Coimpanhia Brasileira de Alumínio','CBA','ON',NULL,NULL,'61.409.892/0001-73',NULL, NULL, NULL, 1),
 (84,'NGRD3','Neogrid','NEOGRID','ON',NULL,NULL,'10.139.870/0001-08',NULL, NULL, NULL, 1);

-- Find the paying source from HGRU11
